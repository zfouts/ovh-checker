<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OVH Inventory Checker</title>
    <script src="https://unpkg.com/vue@3.5.27/dist/vue.global.prod.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/styles.css">
</head>
<body>
    <div id="app">
        <header>
            <div class="container">
                <div class="header-content">
                    <div class="logo">
                        <div class="logo-icon">üì°</div>
                        <h1><a href="#/">OVH Inventory</a></h1>
                    </div>
                    
                    <div class="header-stats">
                        <div class="header-stat">
                            <span>Monitoring</span>
                            <span class="value">{{ totalPlans }} plans</span>
                        </div>
                        <div class="header-stat">
                            <span>Across</span>
                            <span class="value">{{ totalDatacenters }} datacenters</span>
                        </div>
                        <div class="live-indicator">
                            <span class="live-dot"></span>
                            <span>Live</span>
                        </div>
                    </div>
                </div>
                
                <nav class="nav">
                    <a class="nav-item" :class="{ active: activeTab === 'status' }" href="#/status">Status</a>
                    <a class="nav-item" :class="{ active: activeTab === 'compare' }" href="#/compare">Compare</a>
                    <a class="nav-item" :class="{ active: activeTab === 'datacenter' }" href="#/datacenter">Datacenter</a>
                    <a class="nav-item" :class="{ active: activeTab === 'history' }" href="#/history" v-if="isAuthenticated">History</a>
                    <a class="nav-item" :class="{ active: activeTab === 'notifications' }" href="#/notifications" v-if="isAuthenticated">Notifications</a>
                    <a class="nav-item" :class="{ active: activeTab === 'my-alerts' }" href="#/my-alerts" v-if="isAuthenticated">My Alerts</a>
                    <a class="nav-item" :class="{ active: activeTab === 'admin' }" href="#/admin" v-if="isAdmin">Admin</a>
                    <a class="nav-item" :class="{ active: activeTab === 'settings' }" href="#/settings" v-if="isAdmin">Settings</a>
                    
                    <!-- Auth buttons -->
                    <div style="margin-left: auto; display: flex; gap: 8px; align-items: center;">
                        <template v-if="isAuthenticated">
                            <span style="color: var(--text-secondary); font-size: 0.875rem;">{{ currentUser?.email }}</span>
                            <button class="btn btn-ghost btn-sm" @click="logout">Logout</button>
                        </template>
                        <template v-else>
                            <button class="btn btn-ghost btn-sm" @click="showLoginModal = true">Login</button>
                            <button class="btn btn-primary btn-sm" @click="showRegisterModal = true">Sign Up</button>
                        </template>
                    </div>
                </nav>
            </div>
        </header>

        <main>
            <div class="container">
                <!-- Status Tab -->
                <div v-if="activeTab === 'status'">
                    <!-- Subsidiary Tabs -->
                    <div class="subsidiary-tabs" v-if="subsidiariesWithData.length >= 1">
                        <button 
                            v-for="sub in subsidiariesWithData" 
                            :key="sub"
                            class="subsidiary-tab" 
                            :class="{ active: activeSubsidiary === sub }"
                            @click="setActiveSubsidiary(sub)"
                        >
                            <span class="flag">{{ getSubsidiaryFlag(sub) }}</span>
                            <span>{{ getSubsidiaryName(sub) }}</span>
                            <span class="count">{{ getSubsidiaryCount(sub) }}</span>
                        </button>
                        <button 
                            class="subsidiary-tab" 
                            :class="{ active: activeSubsidiary === 'ALL' }"
                            @click="setActiveSubsidiary('ALL')"
                        >
                            <span class="flag">üåç</span>
                            <span>All Regions</span>
                            <span class="count">{{ status.length }}</span>
                        </button>
                    </div>

                    <!-- Stats -->
                    <div class="stats-grid">
                        <div class="stat-card success">
                            <div class="stat-value">{{ stats.available }}</div>
                            <div class="stat-label">Available</div>
                        </div>
                        <div class="stat-card danger">
                            <div class="stat-value">{{ stats.outOfStock }}</div>
                            <div class="stat-label">Out of Stock</div>
                        </div>
                        <div class="stat-card info">
                            <div class="stat-value">{{ stats.plans }}</div>
                            <div class="stat-label">Active Plans</div>
                        </div>
                        <div class="stat-card purple">
                            <div class="stat-value">{{ stats.datacenters }}</div>
                            <div class="stat-label">Datacenters</div>
                        </div>
                    </div>

                    <!-- Region Notice -->
                    <div class="region-notice" v-if="activeSubsidiary !== 'ALL'">
                        <span class="region-flag">{{ getSubsidiaryFlag(activeSubsidiary) }}</span>
                        <div class="region-text">
                            <div v-if="activeSubsidiary === 'FR'"><strong>Global</strong> ‚Äî Availability data for all non-US regions</div>
                            <div v-else><strong>{{ getSubsidiaryName(activeSubsidiary) }}</strong> ‚Äî Availability data for the {{ activeSubsidiary }} subsidiary</div>
                            <div class="region-hint">‚ö†Ô∏è Some datacenters may have regional restrictions. Availability varies by account location and eligibility.</div>
                        </div>
                    </div>
                    <div class="region-notice" v-else>
                        <span class="region-flag">üåç</span>
                        <div class="region-text">
                            <div><strong>All Regions</strong> ‚Äî Monitoring US and Global availability</div>
                            <div class="region-hint">üìä Compare pricing and availability across United States and Global (all other regions)</div>
                        </div>
                    </div>

                    <!-- Filters -->
                    <div class="filters-section card">
                        <div class="card-body">
                            <div class="filters-row">
                                <div class="filter-group">
                                    <label>Search</label>
                                    <input type="text" class="filter-input" v-model="filters.search" 
                                           placeholder="Plan or datacenter..." @input="updateUrl">
                                </div>
                                <div class="filter-group">
                                    <label>Plan</label>
                                    <select class="filter-select" v-model="filters.plan" @change="updateUrl">
                                        <option value="">All Plans</option>
                                        <option v-for="p in availablePlans" :key="p" :value="p">{{ p }}</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label>Datacenter</label>
                                    <select class="filter-select" v-model="filters.datacenter" @change="updateUrl">
                                        <option value="">All Datacenters</option>
                                        <option v-for="dc in availableDatacenters" :key="dc" :value="dc">{{ dc }}</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label>Status</label>
                                    <select class="filter-select" v-model="filters.status" @change="updateUrl">
                                        <option value="">All</option>
                                        <option value="available">Available</option>
                                        <option value="unavailable">Out of Stock</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label>Region</label>
                                    <select class="filter-select" v-model="filters.region" @change="updateUrl">
                                        <option value="">All Regions</option>
                                        <option value="US">US</option>
                                        <option value="EU">EU</option>
                                        <option value="CA">Canada</option>
                                        <option value="APAC">Asia Pacific</option>
                                    </select>
                                </div>
                                <div class="filter-actions">
                                    <button class="btn btn-secondary btn-sm" @click="copyPermalink" title="Copy link">
                                        üîó Share
                                    </button>
                                    <button class="btn btn-ghost btn-sm" @click="clearFilters" v-if="hasActiveFilters">
                                        Clear
                                    </button>
                                </div>
                            </div>
                            
                            <div class="active-filters" v-if="hasActiveFilters">
                                <span v-if="filters.search" class="filter-tag">
                                    Search: {{ filters.search }}
                                    <button @click="filters.search = ''; updateUrl()">&times;</button>
                                </span>
                                <span v-if="filters.plan" class="filter-tag">
                                    Plan: {{ filters.plan }}
                                    <button @click="filters.plan = ''; updateUrl()">&times;</button>
                                </span>
                                <span v-if="filters.datacenter" class="filter-tag">
                                    DC: {{ filters.datacenter }}
                                    <button @click="filters.datacenter = ''; updateUrl()">&times;</button>
                                </span>
                                <span v-if="filters.status" class="filter-tag">
                                    {{ filters.status === 'available' ? 'Available' : 'Out of Stock' }}
                                    <button @click="filters.status = ''; updateUrl()">&times;</button>
                                </span>
                                <span v-if="filters.region" class="filter-tag">
                                    Region: {{ filters.region }}
                                    <button @click="filters.region = ''; updateUrl()">&times;</button>
                                </span>
                            </div>
                        </div>
                    </div>

                    <!-- Loading -->
                    <div v-if="loading && status.length === 0" class="loading">
                        <div class="spinner"></div>
                        <p>Loading inventory status...</p>
                    </div>

                    <!-- Empty State -->
                    <div v-else-if="Object.keys(filteredGroupedStatus).length === 0" class="empty-state card">
                        <h3>No results found</h3>
                        <p>Try adjusting your filters or <a href="#" @click.prevent="clearFilters">clear all filters</a></p>
                    </div>

                    <!-- Plans Grid - Grouped by base plan -->
                    <div v-else class="plans-grid">
                        <!-- Section: Orderable Plans -->
                        <div v-if="Object.keys(orderablePlans).length > 0" class="plans-section">
                            <div class="section-header">
                                <h2 class="section-title">üõí Orderable Plans</h2>
                                <span class="section-badge">{{ Object.keys(orderablePlans).length }} plans</span>
                                <button class="btn btn-ghost btn-sm" @click="toggleCollapseAll('orderable')" style="margin-left: auto;">
                                    {{ allOrderableCollapsed ? '‚ñ∂ Expand All' : '‚ñº Collapse All' }}
                                </button>
                            </div>
                            
                            <div v-for="(plan, basePlan) in orderablePlans" :key="basePlan" 
                                 class="plan-card" :class="{ collapsed: collapsedPlans[basePlan] }">
                                
                                <div class="plan-header" @click="togglePlanCollapse(basePlan)">
                                    <div class="plan-info">
                                        <div class="plan-title-row">
                                            <span class="plan-expand">‚ñº</span>
                                            <span class="plan-name">{{ plan.display_name || formatBasePlanName(basePlan) }}</span>
                                        </div>
                                        <div class="plan-code">{{ basePlan }}</div>
                                        <div class="plan-specs" v-if="plan.specs">
                                            <span class="spec-item">
                                                <span class="spec-icon">üíª</span>
                                                {{ plan.vcpu }} vCPU
                                            </span>
                                            <span class="spec-item">
                                                <span class="spec-icon">üß†</span>
                                                {{ plan.ram_gb }} GB RAM
                                            </span>
                                            <span class="spec-item">
                                                <span class="spec-icon">üíæ</span>
                                                {{ plan.storage_gb }} GB {{ plan.storage_type || 'SSD' }}
                                            </span>
                                            <span class="spec-item" v-if="plan.bandwidth_mbps">
                                                <span class="spec-icon">üåê</span>
                                                {{ plan.bandwidth_mbps }} Mbps
                                            </span>
                                        </div>
                                    </div>
                                    
                                    <div class="plan-actions" @click.stop>
                                        <span class="plan-price" @click="showPricing(basePlan)" title="View pricing">
                                            {{ plan.price || 'View Price' }}
                                        </span>
                                        <a :href="plan.purchase_url || `https://${subsidiary.domain}/vps/`" 
                                           target="_blank" class="plan-order">Order</a>
                                    </div>
                                </div>
                                
                                <div class="plan-summary">
                                    <span class="summary-item">
                                        <span class="summary-dot green"></span>
                                        {{ plan.available_count }} Available
                                    </span>
                                    <span class="summary-item">
                                        <span class="summary-dot red"></span>
                                        {{ plan.unavailable_count }} Out of Stock
                                    </span>
                                    <span class="summary-item" style="color: var(--text-muted);">
                                        {{ plan.datacenters.length }} datacenters
                                    </span>
                                </div>
                                
                                <div class="plan-datacenters" v-show="!collapsedPlans[basePlan]">
                                    <div v-for="dc in plan.datacenters" :key="dc.datacenter"
                                         class="dc-card" 
                                         :class="{ 
                                             available: dc.is_available, 
                                             unavailable: !dc.is_available,
                                             highlighted: filters.datacenter === dc.datacenter
                                         }"
                                         @click="filterByDatacenter(dc.datacenter)">
                                        
                                        <div class="dc-header">
                                            <span class="dc-name">
                                                {{ dc.location_flag || 'üåê' }} {{ dc.location_display_name || dc.location_city || dc.datacenter }}
                                            </span>
                                            <a :href="'#/datacenter?dc=' + encodeURIComponent(dc.datacenter)" 
                                               class="dc-link" @click.stop title="View all plans">üìã</a>
                                        </div>
                                        
                                        <div class="dc-location" v-if="dc.location_country">
                                            {{ dc.location_country }}
                                        </div>
                                        <div class="dc-code">{{ dc.datacenter }}</div>
                                        
                                        <div class="dc-status" :class="{ available: dc.is_available, unavailable: !dc.is_available }">
                                            {{ dc.is_available ? '‚úì Available' : '‚úó Out of Stock' }}
                                        </div>
                                        
                                        <div class="dc-details">
                                            <span>üêß {{ dc.linux_status }}</span>
                                        </div>
                                        
                                        <div v-if="!dc.is_available && dc.out_of_stock_minutes > 1" class="dc-outage">
                                            ‚è± Out for {{ formatDuration(dc.out_of_stock_minutes) }}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Section: Legacy Plans -->
                        <div v-if="Object.keys(internalPlans).length > 0" class="plans-section internal-section">
                            <div class="section-header" style="cursor: pointer;">
                                <div style="display: flex; align-items: center; gap: 12px;" @click="showInternalPlans = !showInternalPlans">
                                    <span class="plan-expand" :style="{ transform: showInternalPlans ? 'rotate(0)' : 'rotate(-90deg)' }">‚ñº</span>
                                    <h2 class="section-title">üì¶ Legacy Plans</h2>
                                    <span class="section-badge muted">{{ Object.keys(internalPlans).length }} plans</span>
                                </div>
                                <button v-if="showInternalPlans" class="btn btn-ghost btn-sm" @click.stop="toggleCollapseAll('internal')" style="margin-left: auto;">
                                    {{ allInternalCollapsed ? '‚ñ∂ Expand All' : '‚ñº Collapse All' }}
                                </button>
                                <span class="section-hint" @click="showInternalPlans = !showInternalPlans">Older plans not available for new orders</span>
                            </div>
                            
                            <div v-show="showInternalPlans">
                                <div v-for="(plan, basePlan) in internalPlans" :key="basePlan" 
                                     class="plan-card internal" :class="{ collapsed: collapsedPlans[basePlan] }">
                                    
                                    <div class="plan-header" @click="togglePlanCollapse(basePlan)">
                                        <div class="plan-info">
                                            <div class="plan-title-row">
                                                <span class="plan-expand">‚ñº</span>
                                                <span class="plan-name">{{ plan.display_name || formatBasePlanName(basePlan) }}</span>
                                                <span class="badge badge-muted" style="margin-left: 8px;">Website Only</span>
                                            </div>
                                            <div class="plan-code">{{ basePlan }}</div>
                                            <div class="plan-specs" v-if="plan.specs">
                                                <span class="spec-item">
                                                    <span class="spec-icon">üíª</span>
                                                    {{ plan.vcpu }} vCPU
                                                </span>
                                                <span class="spec-item">
                                                    <span class="spec-icon">üß†</span>
                                                    {{ plan.ram_gb }} GB RAM
                                                </span>
                                                <span class="spec-item">
                                                    <span class="spec-icon">üíæ</span>
                                                    {{ plan.storage_gb }} GB {{ plan.storage_type || 'SSD' }}
                                                </span>
                                                <span class="spec-item" v-if="plan.bandwidth_mbps">
                                                    <span class="spec-icon">üåê</span>
                                                    {{ plan.bandwidth_mbps }} Mbps
                                                </span>
                                            </div>
                                        </div>
                                        
                                        <div class="plan-actions" @click.stop>
                                            <span class="plan-price muted" @click="showPricing(basePlan)" title="View pricing">
                                                {{ plan.price || 'View Price' }}
                                            </span>
                                        </div>
                                    </div>
                                    
                                    <div class="plan-summary">
                                        <span class="summary-item">
                                            <span class="summary-dot green"></span>
                                            {{ plan.available_count }} Available
                                        </span>
                                        <span class="summary-item">
                                            <span class="summary-dot red"></span>
                                            {{ plan.unavailable_count }} Out of Stock
                                        </span>
                                        <span class="summary-item" style="color: var(--text-muted);">
                                            {{ plan.datacenters.length }} datacenters
                                        </span>
                                    </div>
                                    
                                    <div class="plan-datacenters" v-show="!collapsedPlans[basePlan]">
                                        <div v-for="dc in plan.datacenters" :key="dc.datacenter"
                                             class="dc-card" 
                                             :class="{ 
                                                 available: dc.is_available, 
                                                 unavailable: !dc.is_available,
                                                 highlighted: filters.datacenter === dc.datacenter
                                             }"
                                             @click="filterByDatacenter(dc.datacenter)">
                                            
                                            <div class="dc-header">
                                                <span class="dc-name">
                                                    {{ dc.location_flag || 'üåê' }} {{ dc.location_display_name || dc.location_city || dc.datacenter }}
                                                </span>
                                                <a :href="'#/datacenter?dc=' + encodeURIComponent(dc.datacenter)" 
                                                   class="dc-link" @click.stop title="View all plans">üìã</a>
                                            </div>
                                            
                                            <div class="dc-location" v-if="dc.location_country">
                                                {{ dc.location_country }}
                                            </div>
                                            <div class="dc-code">{{ dc.datacenter }}</div>
                                            
                                            <div class="dc-status" :class="{ available: dc.is_available, unavailable: !dc.is_available }">
                                                {{ dc.is_available ? '‚úì Available' : '‚úó Out of Stock' }}
                                            </div>
                                            
                                            <div class="dc-details">
                                                <span>üêß {{ dc.linux_status }}</span>
                                            </div>
                                            
                                            <div v-if="!dc.is_available && dc.out_of_stock_minutes > 1" class="dc-outage">
                                                ‚è± Out for {{ formatDuration(dc.out_of_stock_minutes) }}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Compare Tab -->
                <div v-if="activeTab === 'compare'">
                    <div class="compare-header" style="margin-bottom: 24px;">
                        <h2 style="font-size: 1.5rem; font-weight: 600; margin-bottom: 8px;">üîÑ US vs Global Price Comparison</h2>
                        <p style="color: var(--text-secondary);">Compare VPS pricing and availability between US and Global (Europe/International) regions</p>
                        <div v-if="compareData?.exchange_rate" style="margin-top: 8px; font-size: 0.85rem; color: var(--text-muted);">
                            üí± Exchange Rate: 1 EUR = {{ compareData.exchange_rate.eur_usd.toFixed(4) }} USD
                            <span v-if="compareData.exchange_rate.last_updated" style="margin-left: 8px;">
                                (Updated: {{ formatDate(compareData.exchange_rate.last_updated) }})
                            </span>
                        </div>
                    </div>

                    <!-- Compare Stats -->
                    <div class="stats-grid" style="margin-bottom: 24px;">
                        <div class="stat-card info">
                            <div class="stat-value">{{ compareData?.summary?.us_plans || 0 }}</div>
                            <div class="stat-label">üá∫üá∏ US Plans</div>
                        </div>
                        <div class="stat-card purple">
                            <div class="stat-value">{{ compareData?.summary?.global_plans || 0 }}</div>
                            <div class="stat-label">üåç Global Plans</div>
                        </div>
                        <div class="stat-card success">
                            <div class="stat-value">{{ compareData?.summary?.comparable_plans || 0 }}</div>
                            <div class="stat-label">Comparable</div>
                        </div>
                        <div class="stat-card" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white;">
                            <div class="stat-value">{{ compareData?.summary?.us_cheaper || 0 }}</div>
                            <div class="stat-label">üá∫üá∏ Cheaper</div>
                        </div>
                        <div class="stat-card" style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); color: white;">
                            <div class="stat-value">{{ compareData?.summary?.global_cheaper || 0 }}</div>
                            <div class="stat-label">üåç Cheaper</div>
                        </div>
                    </div>

                    <!-- Best Value Recommendations -->
                    <div v-if="compareData?.recommendations" class="card" style="margin-bottom: 24px;">
                        <div class="card-header" style="padding: 16px; border-bottom: 1px solid var(--border);">
                            <h3 style="font-size: 1.1rem; font-weight: 600;">üí° Best Value Recommendations</h3>
                            <p style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 4px;">Top picks based on cost efficiency for different workload priorities</p>
                        </div>
                        <div class="card-body" style="padding: 16px;">
                            <!-- Best Overall Pick -->
                            <div v-if="compareData.recommendations.best_overall?.length" 
                                 style="background: linear-gradient(135deg, rgba(96, 165, 250, 0.1), rgba(168, 85, 247, 0.1)); border-radius: var(--radius); padding: 20px; border: 2px solid var(--primary); margin-bottom: 20px;">
                                <h4 style="font-size: 1rem; font-weight: 600; margin-bottom: 12px; color: var(--primary); display: flex; align-items: center; gap: 8px;">
                                    ‚≠ê Best Overall Value
                                    <span style="font-size: 0.75rem; font-weight: 400; color: var(--text-muted);">(Balanced CPU, RAM & Storage)</span>
                                </h4>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 16px;">
                                    <div v-for="(rec, idx) in compareData.recommendations.best_overall.slice(0, 3)" :key="'overall-' + idx"
                                         style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: var(--bg-secondary); border-radius: 8px; border: 1px solid var(--border);">
                                        <div>
                                            <div style="font-weight: 600; font-size: 0.95rem; display: flex; align-items: center; gap: 6px;">
                                                <span v-if="idx === 0">ü•á</span>
                                                <span v-else-if="idx === 1">ü•à</span>
                                                <span v-else>ü•â</span>
                                                {{ rec.display_name || rec.plan }}
                                            </div>
                                            <div style="font-size: 0.75rem; color: var(--text-muted);">{{ rec.specs }}</div>
                                        </div>
                                        <div style="text-align: right;">
                                            <div style="font-weight: 600; font-size: 1rem;" :style="{ color: rec.region === 'US' ? 'var(--success)' : 'var(--purple)' }">
                                                ${{ rec.price?.toFixed(2) }}/mo
                                            </div>
                                            <div style="font-size: 0.7rem; color: var(--text-muted);">{{ rec.region === 'US' ? 'üá∫üá∏ US' : 'üåç Global' }}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                                <!-- Best for CPU -->
                                <div style="background: var(--bg-secondary); border-radius: var(--radius); padding: 16px; border: 1px solid var(--border);">
                                    <h4 style="font-size: 0.95rem; font-weight: 600; margin-bottom: 12px; color: var(--accent);">
                                        üî• Best for CPU-Intensive Workloads
                                    </h4>
                                    <p style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 12px;">Lowest {{ compareData.recommendations.metrics?.cpu_label || '$/vCPU' }}</p>
                                    <div v-for="(rec, idx) in compareData.recommendations.best_for_cpu?.slice(0, 3)" :key="'cpu-' + idx"
                                         style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid var(--border-light);">
                                        <div>
                                            <div style="font-weight: 500; font-size: 0.9rem;">{{ rec.display_name || rec.plan }}</div>
                                            <div style="font-size: 0.75rem; color: var(--text-muted);">{{ rec.specs }}</div>
                                        </div>
                                        <div style="text-align: right;">
                                            <div style="font-weight: 600; font-size: 0.9rem;" :style="{ color: rec.region === 'US' ? 'var(--success)' : 'var(--purple)' }">
                                                ${{ rec.value.toFixed(2) }}/vCPU
                                            </div>
                                            <div style="font-size: 0.7rem; color: var(--text-muted);">{{ rec.region === 'US' ? 'üá∫üá∏' : 'üåç' }} ${{ rec.price?.toFixed(2) }}/mo</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Best for RAM -->
                                <div style="background: var(--bg-secondary); border-radius: var(--radius); padding: 16px; border: 1px solid var(--border);">
                                    <h4 style="font-size: 0.95rem; font-weight: 600; margin-bottom: 12px; color: var(--success);">
                                        üß† Best for Memory-Intensive Workloads
                                    </h4>
                                    <p style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 12px;">Lowest {{ compareData.recommendations.metrics?.ram_label || '$/GB RAM' }}</p>
                                    <div v-for="(rec, idx) in compareData.recommendations.best_for_ram?.slice(0, 3)" :key="'ram-' + idx"
                                         style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid var(--border-light);">
                                        <div>
                                            <div style="font-weight: 500; font-size: 0.9rem;">{{ rec.display_name || rec.plan }}</div>
                                            <div style="font-size: 0.75rem; color: var(--text-muted);">{{ rec.specs }}</div>
                                        </div>
                                        <div style="text-align: right;">
                                            <div style="font-weight: 600; font-size: 0.9rem;" :style="{ color: rec.region === 'US' ? 'var(--success)' : 'var(--purple)' }">
                                                ${{ rec.value.toFixed(2) }}/GB
                                            </div>
                                            <div style="font-size: 0.7rem; color: var(--text-muted);">{{ rec.region === 'US' ? 'üá∫üá∏' : 'üåç' }} ${{ rec.price?.toFixed(2) }}/mo</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Best for Storage -->
                                <div style="background: var(--bg-secondary); border-radius: var(--radius); padding: 16px; border: 1px solid var(--border);">
                                    <h4 style="font-size: 0.95rem; font-weight: 600; margin-bottom: 12px; color: var(--warning);">
                                        üíæ Best for Storage-Intensive Workloads
                                    </h4>
                                    <p style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 12px;">Lowest {{ compareData.recommendations.metrics?.storage_label || '$/GB Storage' }}</p>
                                    <div v-for="(rec, idx) in compareData.recommendations.best_for_storage?.slice(0, 3)" :key="'storage-' + idx"
                                         style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid var(--border-light);">
                                        <div>
                                            <div style="font-weight: 500; font-size: 0.9rem;">{{ rec.display_name || rec.plan }}</div>
                                            <div style="font-size: 0.75rem; color: var(--text-muted);">{{ rec.specs }}</div>
                                        </div>
                                        <div style="text-align: right;">
                                            <div style="font-weight: 600; font-size: 0.9rem;" :style="{ color: rec.region === 'US' ? 'var(--success)' : 'var(--purple)' }">
                                                ${{ rec.value.toFixed(4) }}/GB
                                            </div>
                                            <div style="font-size: 0.7rem; color: var(--text-muted);">{{ rec.region === 'US' ? 'üá∫üá∏' : 'üåç' }} ${{ rec.price?.toFixed(2) }}/mo</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Filters -->
                    <div class="filters-section card" style="margin-bottom: 24px;">
                        <div class="card-body">
                            <div class="filters-row">
                                <div class="filter-group">
                                    <label>Search</label>
                                    <input type="text" class="filter-input" v-model="compareFilters.search" 
                                           placeholder="Plan name...">
                                </div>
                                <div class="filter-group">
                                    <label>Availability</label>
                                    <select class="filter-select" v-model="compareFilters.show">
                                        <option value="all">All Plans</option>
                                        <option value="both">Available in Both</option>
                                        <option value="us-only">US Only</option>
                                        <option value="global-only">Global Only</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label>Price Winner</label>
                                    <select class="filter-select" v-model="compareFilters.priceWinner">
                                        <option value="">All</option>
                                        <option value="us">üá∫üá∏ US Cheaper</option>
                                        <option value="global">üåç Global Cheaper</option>
                                        <option value="same">Same Price</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label>Product Line</label>
                                    <select class="filter-select" v-model="compareFilters.productLine">
                                        <option value="">All</option>
                                        <option value="2025">VPS 2025</option>
                                        <option value="legacy">Legacy</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Comparison Table -->
                    <div class="card">
                        <div class="card-body" style="overflow-x: auto;">
                            <table class="compare-table" style="width: 100%; border-collapse: collapse;">
                                <thead>
                                    <tr style="border-bottom: 2px solid var(--border);">
                                        <th style="text-align: left; padding: 12px 16px; font-weight: 600;">Plan</th>
                                        <th style="text-align: left; padding: 12px 16px; font-weight: 600;">Specs</th>
                                        <th style="text-align: center; padding: 12px 16px; font-weight: 600;">üá∫üá∏ US Price</th>
                                        <th style="text-align: center; padding: 12px 16px; font-weight: 600;">üåç Global Price</th>
                                        <th style="text-align: center; padding: 12px 16px; font-weight: 600;">üí∞ Difference</th>
                                        <th style="text-align: center; padding: 12px 16px; font-weight: 600;">üá∫üá∏ Availability</th>
                                        <th style="text-align: center; padding: 12px 16px; font-weight: 600;">üåç Availability</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-for="item in filteredCompareData" :key="item.base_plan"
                                        style="border-bottom: 1px solid var(--border-light);"
                                        :style="{ opacity: item.is_orderable === false ? 0.6 : 1 }">
                                        <td style="padding: 12px 16px;">
                                            <div style="font-weight: 500;">{{ item.display_name || item.base_plan }}</div>
                                            <div style="font-size: 0.75rem; color: var(--text-muted);">{{ item.base_plan }}</div>
                                            <span v-if="item.product_line === '2025'" class="badge" 
                                                  style="background: var(--accent); color: white; font-size: 0.65rem; padding: 2px 6px; border-radius: 4px; margin-top: 4px; display: inline-block;">
                                                VPS 2025
                                            </span>
                                        </td>
                                        <td style="padding: 12px 16px; font-size: 0.875rem; color: var(--text-secondary);">
                                            <div v-if="item.specs">{{ item.specs }}</div>
                                            <div v-else-if="item.vcpu">{{ item.vcpu }} vCPU ‚Ä¢ {{ item.ram_gb }} GB RAM</div>
                                        </td>
                                        <td style="padding: 12px 16px; text-align: center;">
                                            <div v-if="item.us && item.us.price_usd" style="font-weight: 600; color: var(--success);">
                                                ${{ item.us.price_usd.toFixed(2) }}
                                                <div style="font-size: 0.7rem; color: var(--text-muted);">/mo</div>
                                            </div>
                                            <div v-else style="color: var(--text-muted);">‚Äî</div>
                                        </td>
                                        <td style="padding: 12px 16px; text-align: center;">
                                            <div v-if="item.global && item.global.price">
                                                <div style="font-weight: 600; color: var(--purple);">
                                                    {{ item.global.price }}
                                                </div>
                                                <div v-if="item.global.price_usd" style="font-size: 0.7rem; color: var(--text-muted);">
                                                    ‚âà ${{ item.global.price_usd.toFixed(2) }} /mo
                                                </div>
                                            </div>
                                            <div v-else style="color: var(--text-muted);">‚Äî</div>
                                        </td>
                                        <td style="padding: 12px 16px; text-align: center;">
                                            <div v-if="item.price_comparison && item.price_comparison.cheaper_region">
                                                <div :style="{ 
                                                    color: item.price_comparison.cheaper_region === 'US' ? 'var(--success)' : 'var(--purple)',
                                                    fontWeight: '600'
                                                }">
                                                    {{ item.price_comparison.cheaper_region === 'US' ? 'üá∫üá∏' : 'üåç' }}
                                                    {{ item.price_comparison.cheaper_region }}
                                                </div>
                                                <div style="font-size: 0.75rem; margin-top: 2px;">
                                                    <span :style="{ color: item.price_comparison.difference > 0 ? 'var(--danger)' : 'var(--success)' }">
                                                        {{ item.price_comparison.difference > 0 ? '+' : '' }}${{ item.price_comparison.difference.toFixed(2) }}
                                                    </span>
                                                    <span style="color: var(--text-muted);">
                                                        ({{ item.price_comparison.difference_percent.toFixed(1) }}%)
                                                    </span>
                                                </div>
                                            </div>
                                            <div v-else-if="item.price_comparison && !item.price_comparison.cheaper_region" style="color: var(--text-muted);">
                                                Same
                                            </div>
                                            <div v-else style="color: var(--text-muted);">‚Äî</div>
                                        </td>
                                        <td style="padding: 12px 16px; text-align: center;">
                                            <div v-if="item.us">
                                                <span :class="item.us.available_count > 0 ? 'status-available' : 'status-unavailable'"
                                                      style="padding: 4px 8px; border-radius: 4px; font-size: 0.875rem;">
                                                    {{ item.us.available_count }}/{{ item.us.total_count }}
                                                </span>
                                                <div style="font-size: 0.7rem; color: var(--text-muted); margin-top: 2px;">
                                                    {{ item.us.available_count > 0 ? 'In Stock' : 'Out of Stock' }}
                                                </div>
                                            </div>
                                            <div v-else style="color: var(--text-muted);">N/A</div>
                                        </td>
                                        <td style="padding: 12px 16px; text-align: center;">
                                            <div v-if="item.global">
                                                <span :class="item.global.available_count > 0 ? 'status-available' : 'status-unavailable'"
                                                      style="padding: 4px 8px; border-radius: 4px; font-size: 0.875rem;">
                                                    {{ item.global.available_count }}/{{ item.global.total_count }}
                                                </span>
                                                <div style="font-size: 0.7rem; color: var(--text-muted); margin-top: 2px;">
                                                    {{ item.global.available_count > 0 ? 'In Stock' : 'Out of Stock' }}
                                                </div>
                                            </div>
                                            <div v-else style="color: var(--text-muted);">N/A</div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            
                            <div v-if="!filteredCompareData.length" class="empty-state" style="padding: 48px; text-align: center;">
                                <div style="font-size: 3rem; margin-bottom: 16px;">üìä</div>
                                <div style="color: var(--text-secondary);">No comparison data available</div>
                            </div>
                        </div>
                    </div>

                    <!-- Datacenter Breakdown (expandable) -->
                    <div class="card" style="margin-top: 24px;">
                        <div class="card-header" style="padding: 16px; border-bottom: 1px solid var(--border); cursor: pointer;"
                             @click="showDcBreakdown = !showDcBreakdown">
                            <h3 style="font-size: 1rem; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                                <span>{{ showDcBreakdown ? '‚ñº' : '‚ñ∂' }}</span>
                                <span>Datacenter Availability Breakdown</span>
                            </h3>
                        </div>
                        <div class="card-body" v-if="showDcBreakdown">
                            <div v-for="item in filteredCompareData.slice(0, 5)" :key="'dc-' + item.base_plan" 
                                 style="margin-bottom: 24px; padding-bottom: 24px; border-bottom: 1px solid var(--border-light);">
                                <h4 style="font-weight: 600; margin-bottom: 12px;">{{ item.display_name || item.base_plan }}</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                                    <!-- US Datacenters -->
                                    <div>
                                        <div style="font-weight: 500; margin-bottom: 8px; color: var(--text-secondary);">üá∫üá∏ US Datacenters</div>
                                        <div v-if="item.us" style="display: flex; flex-wrap: wrap; gap: 6px;">
                                            <span v-for="dc in item.us.datacenters" :key="dc.datacenter"
                                                  :class="dc.is_available ? 'dc-chip-available' : 'dc-chip-unavailable'"
                                                  style="padding: 4px 8px; border-radius: 4px; font-size: 0.75rem;">
                                                {{ dc.location_flag || 'üåê' }} {{ dc.location_display_name || dc.datacenter }}
                                            </span>
                                        </div>
                                        <div v-else style="color: var(--text-muted); font-size: 0.875rem;">Not available in US</div>
                                    </div>
                                    <!-- Global Datacenters -->
                                    <div>
                                        <div style="font-weight: 500; margin-bottom: 8px; color: var(--text-secondary);">üåç Global Datacenters</div>
                                        <div v-if="item.global" style="display: flex; flex-wrap: wrap; gap: 6px;">
                                            <span v-for="dc in item.global.datacenters" :key="dc.datacenter"
                                                  :class="dc.is_available ? 'dc-chip-available' : 'dc-chip-unavailable'"
                                                  style="padding: 4px 8px; border-radius: 4px; font-size: 0.75rem;">
                                                {{ dc.location_flag || 'üåê' }} {{ dc.location_display_name || dc.datacenter }}
                                            </span>
                                        </div>
                                        <div v-else style="color: var(--text-muted); font-size: 0.875rem;">Not available globally</div>
                                    </div>
                                </div>
                            </div>
                            <div v-if="filteredCompareData.length > 5" style="text-align: center; color: var(--text-muted); padding: 12px;">
                                Showing first 5 plans. Filter to see more details.
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Datacenter Tab -->
                <div v-if="activeTab === 'datacenter'">
                    <div class="card" style="margin-bottom: 24px;">
                        <div class="card-body">
                            <div class="filters-row">
                                <div class="filter-group" style="flex: 1;">
                                    <label>Select Datacenter</label>
                                    <select class="filter-select" v-model="selectedDatacenter" style="width: 100%;">
                                        <option value="">Choose a datacenter...</option>
                                        <option v-for="dc in availableDatacenters" :key="dc" :value="dc">{{ dc }}</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- No datacenter selected -->
                    <div v-if="!selectedDatacenter" class="empty-state card">
                        <h3>üåç Select a Datacenter</h3>
                        <p>Choose a datacenter above to see all available plans and their stock status.</p>
                    </div>

                    <!-- Datacenter Info -->
                    <div v-else-if="datacenterInfo">
                        <div class="card" style="margin-bottom: 24px;">
                            <div class="card-body">
                                <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 16px;">
                                    <div>
                                        <h2 style="font-size: 1.5rem; margin-bottom: 8px;">
                                            {{ datacenterInfo.location_flag || 'üåê' }} {{ datacenterInfo.location_display_name || datacenterInfo.location_city || datacenterInfo.datacenter }}
                                        </h2>
                                        <div style="color: var(--text-secondary);">
                                            <span v-if="datacenterInfo.location_country">{{ datacenterInfo.location_country }} ‚Ä¢ </span>
                                            <code style="background: var(--bg-tertiary); padding: 2px 8px; border-radius: 4px;">{{ datacenterInfo.datacenter }}</code>
                                        </div>
                                    </div>
                                    <div style="display: flex; gap: 24px;">
                                        <div style="text-align: center;">
                                            <div style="font-size: 1.5rem; font-weight: 600; color: var(--success);">{{ datacenterInfo.available }}</div>
                                            <div style="font-size: 0.75rem; color: var(--text-muted); text-transform: uppercase;">Available</div>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="font-size: 1.5rem; font-weight: 600; color: var(--danger);">{{ datacenterInfo.unavailable }}</div>
                                            <div style="font-size: 0.75rem; color: var(--text-muted); text-transform: uppercase;">Out of Stock</div>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="font-size: 1.5rem; font-weight: 600; color: var(--text-secondary);">{{ datacenterInfo.total }}</div>
                                            <div style="font-size: 0.75rem; color: var(--text-muted); text-transform: uppercase;">Total Plans</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Plans Table -->
                        <div class="card">
                            <div class="card-header">
                                <span class="card-title">Plans in {{ selectedDatacenter }}</span>
                            </div>
                            <div class="table-wrapper" style="max-height: none;">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Plan</th>
                                            <th>Specs</th>
                                            <th>Price</th>
                                            <th>Status</th>
                                            <th>Orderable</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="plan in datacenterPlans" :key="plan.plan_code">
                                            <td>
                                                <div style="font-weight: 500;">{{ plan.display_name_clean || formatBasePlanName(plan.base_plan) }}</div>
                                                <div style="font-size: 0.75rem; color: var(--text-muted);">{{ plan.plan_code }}</div>
                                            </td>
                                            <td>
                                                <div v-if="plan.specs" style="font-size: 0.8rem;">
                                                    <span>{{ plan.vcpu }} vCPU</span> ‚Ä¢ 
                                                    <span>{{ plan.ram_gb }} GB RAM</span> ‚Ä¢ 
                                                    <span>{{ plan.storage_gb }} GB {{ plan.storage_type || 'SSD' }}</span>
                                                </div>
                                                <span v-else style="color: var(--text-muted);">‚Äî</span>
                                            </td>
                                            <td>
                                                <span v-if="plan.price" style="color: var(--accent); font-weight: 500;">{{ plan.price }}</span>
                                                <span v-else style="color: var(--text-muted);">‚Äî</span>
                                            </td>
                                            <td>
                                                <span class="badge" :class="plan.is_available ? 'badge-success' : 'badge-danger'">
                                                    {{ plan.is_available ? '‚úì Available' : '‚úó Out of Stock' }}
                                                </span>
                                            </td>
                                            <td>
                                                <span v-if="plan.is_orderable" class="badge badge-info">üõí Yes</span>
                                                <span v-else class="badge badge-muted">üì¶ Internal</span>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- History Tab -->
                <div v-if="activeTab === 'history'">
                    <div v-if="!isAuthenticated" class="empty-state card">
                        <h3>üìä Status History</h3>
                        <p>Sign in to view detailed status history.</p>
                        <button class="btn btn-primary" @click="showLoginModal = true" style="margin-top: 16px;">
                            Login to Continue
                        </button>
                    </div>
                    <div v-else class="card">
                        <div class="card-header">
                            <span class="card-title">Status History</span>
                            <div style="display: flex; gap: 12px;">
                                <select class="filter-select" v-model="historyFilters.plan" @change="fetchHistory" style="width: auto;">
                                    <option value="">All Plans</option>
                                    <option v-for="p in availablePlans" :key="p" :value="p">{{ p }}</option>
                                </select>
                                <select class="filter-select" v-model="historyFilters.limit" @change="fetchHistory" style="width: auto;">
                                    <option :value="50">50</option>
                                    <option :value="100">100</option>
                                    <option :value="250">250</option>
                                    <option :value="500">500</option>
                                </select>
                            </div>
                        </div>
                        <div v-if="historyLoading" class="loading">
                            <div class="spinner"></div>
                        </div>
                        <div v-else class="table-wrapper">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Time</th>
                                        <th>Plan</th>
                                        <th>Datacenter</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-for="item in history" :key="item.checked_at + item.plan_code + item.datacenter">
                                        <td>{{ formatDate(item.checked_at) }}</td>
                                        <td>
                                            <a :href="'#/status?plan=' + encodeURIComponent(item.plan_code)">
                                                {{ item.plan_code }}
                                            </a>
                                        </td>
                                        <td>
                                            <a :href="'#/status?datacenter=' + encodeURIComponent(item.datacenter)">
                                                {{ item.datacenter }}
                                            </a>
                                        </td>
                                        <td>
                                            <span class="badge" :class="item.is_available ? 'badge-success' : 'badge-danger'">
                                                {{ item.is_available ? 'Available' : 'Out of Stock' }}
                                            </span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Notifications Tab -->
                <div v-if="activeTab === 'notifications'">
                    <div v-if="!isAuthenticated" class="empty-state card">
                        <h3>üîî Notification History</h3>
                        <p>Sign in to view notification history.</p>
                        <button class="btn btn-primary" @click="showLoginModal = true" style="margin-top: 16px;">
                            Login to Continue
                        </button>
                    </div>
                    <div v-else class="card">
                        <div class="card-header">
                            <span class="card-title">Notification History</span>
                        </div>
                        <div v-if="notificationsLoading" class="loading">
                            <div class="spinner"></div>
                        </div>
                        <div v-else-if="notifications.length === 0" class="empty-state">
                            <h3>No notifications yet</h3>
                            <p>Notifications appear when items return to stock after 60+ minutes unavailability.</p>
                        </div>
                        <div v-else class="table-wrapper">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Time</th>
                                        <th>Plan</th>
                                        <th>Datacenter</th>
                                        <th>Message</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-for="item in notifications" :key="item.sent_at + item.plan_code">
                                        <td>{{ formatDate(item.sent_at) }}</td>
                                        <td>
                                            <a :href="'#/status?plan=' + encodeURIComponent(item.plan_code)">
                                                {{ item.plan_code }}
                                            </a>
                                        </td>
                                        <td>{{ item.datacenter }}</td>
                                        <td style="max-width: 300px; overflow: hidden; text-overflow: ellipsis;">
                                            {{ item.message }}
                                        </td>
                                        <td>
                                            <span class="badge" :class="item.success ? 'badge-success' : 'badge-danger'">
                                                {{ item.success ? 'Sent' : 'Failed' }}
                                            </span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Admin Tab (User Management) -->
                <div v-if="activeTab === 'admin'">
                    <div v-if="!isAdmin" class="alert alert-danger">
                        You must be logged in as an admin to access this page.
                    </div>
                    <template v-else>
                        <!-- Admin Settings Card -->
                        <div class="card" style="margin-bottom: 24px;">
                            <div class="card-header">
                                <span class="card-title">‚öôÔ∏è Admin Settings</span>
                            </div>
                            <div class="card-body">
                                <div v-if="adminSettingsMessage" class="alert" :class="adminSettingsSuccess ? 'alert-success' : 'alert-danger'">
                                    {{ adminSettingsMessage }}
                                </div>
                                
                                <!-- OVH Subsidiary Setting -->
                                <div style="margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px solid var(--border-color);">
                                    <h4 style="margin-bottom: 12px; font-size: 14px; font-weight: 600;">üåç OVH Subsidiary Region</h4>
                                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                                        <select v-model="selectedSubsidiary" @change="updateSubsidiary" class="filter-select" style="width: 250px;">
                                            <option v-for="sub in availableSubsidiaries" :key="sub.code" :value="sub.code">
                                                {{ sub.flag }} {{ sub.name }} ({{ sub.code }})
                                            </option>
                                        </select>
                                        <span v-if="subsidiaryUpdating" class="spinner-sm"></span>
                                    </div>
                                    <p class="form-hint">Select which OVH subsidiary's catalog to monitor. Different subsidiaries have different datacenter availability.</p>
                                </div>
                                
                                <!-- Registration Setting -->
                                <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 16px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="checkbox" v-model="allowRegistration" @change="toggleRegistration">
                                        <span>Allow Public Registration</span>
                                    </label>
                                    <span class="badge" :class="allowRegistration ? 'badge-success' : 'badge-danger'">
                                        {{ allowRegistration ? 'Enabled' : 'Disabled' }}
                                    </span>
                                </div>
                                <p class="form-hint">When disabled, only admins can create new user accounts.</p>
                                
                                <!-- Checker Settings -->
                                <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--border-color);">
                                    <h4 style="margin-bottom: 12px; font-size: 14px; font-weight: 600;">‚è±Ô∏è Checker Agent Settings</h4>
                                    <p class="form-hint" style="margin-bottom: 16px;">Configure how frequently checker agents poll OVH and when to send notifications. Changes take effect on the next check cycle.</p>
                                    
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px;">
                                        <div>
                                            <label style="display: block; margin-bottom: 6px; font-size: 13px; font-weight: 500;">Check Interval (seconds)</label>
                                            <input type="number" v-model.number="checkerSettings.check_interval_seconds" 
                                                   min="30" max="3600" step="10"
                                                   class="form-input" style="width: 100%;">
                                            <p class="form-hint" style="margin-top: 4px;">How often to check OVH API (30-3600s)</p>
                                        </div>
                                        <div>
                                            <label style="display: block; margin-bottom: 6px; font-size: 13px; font-weight: 500;">Notification Threshold (minutes)</label>
                                            <input type="number" v-model.number="checkerSettings.notification_threshold_minutes" 
                                                   min="1" max="1440" step="1"
                                                   class="form-input" style="width: 100%;">
                                            <p class="form-hint" style="margin-top: 4px;">Min out-of-stock time before notifying (1-1440m)</p>
                                        </div>
                                    </div>
                                    
                                    <div style="display: flex; align-items: center; gap: 12px;">
                                        <button class="btn btn-primary btn-sm" @click="saveCheckerSettings" :disabled="savingCheckerSettings">
                                            <span v-if="savingCheckerSettings">Saving...</span>
                                            <span v-else>üíæ Save Checker Settings</span>
                                        </button>
                                        <span v-if="checkerSettingsMessage" :class="checkerSettingsSuccess ? 'text-success' : 'text-danger'" style="font-size: 13px;">
                                            {{ checkerSettingsMessage }}
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- User Management Card -->
                        <div class="card" style="margin-bottom: 24px;">
                            <div class="card-header">
                                <span class="card-title">üë• User Management</span>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                    <span class="badge badge-info">{{ adminUsers.length }} users</span>
                                    <button class="btn btn-primary btn-sm" @click="showCreateUserModal = true">
                                        + Create User
                                    </button>
                                </div>
                            </div>
                            <div class="table-wrapper">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>Email</th>
                                            <th>Username</th>
                                            <th>Status</th>
                                            <th>Role</th>
                                            <th>Created</th>
                                            <th>Last Login</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="user in adminUsers" :key="user.id">
                                            <td>{{ user.id }}</td>
                                            <td>{{ user.email }}</td>
                                            <td>{{ user.username }}</td>
                                            <td>
                                                <span class="badge" :class="user.is_active ? 'badge-success' : 'badge-danger'">
                                                    {{ user.is_active ? 'Active' : 'Disabled' }}
                                                </span>
                                            </td>
                                            <td>
                                                <span class="badge" :class="user.is_admin ? 'badge-purple' : 'badge-muted'">
                                                    {{ user.is_admin ? 'Admin' : 'User' }}
                                                </span>
                                            </td>
                                            <td>{{ formatDate(user.created_at) }}</td>
                                            <td>{{ user.last_login ? formatDate(user.last_login) : 'Never' }}</td>
                                            <td>
                                                <div style="display: flex; gap: 4px;">
                                                    <button class="btn btn-ghost btn-sm" 
                                                            @click="toggleUserActive(user)"
                                                            :disabled="user.id === currentUser?.id"
                                                            :title="user.is_active ? 'Disable User' : 'Enable User'">
                                                        {{ user.is_active ? 'üö´' : '‚úÖ' }}
                                                    </button>
                                                    <button class="btn btn-ghost btn-sm" 
                                                            @click="toggleUserAdmin(user)"
                                                            :disabled="user.id === currentUser?.id"
                                                            :title="user.is_admin ? 'Remove Admin' : 'Make Admin'">
                                                        {{ user.is_admin ? 'üë§' : 'üëë' }}
                                                    </button>
                                                    <button class="btn btn-ghost btn-sm" 
                                                            @click="confirmDeleteUser(user)"
                                                            :disabled="user.id === currentUser?.id"
                                                            title="Delete User">
                                                        üóëÔ∏è
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Groups Management Card -->
                        <div class="card">
                            <div class="card-header">
                                <span class="card-title">üè¢ Groups</span>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                    <span class="badge badge-info">{{ adminGroups.length }} groups</span>
                                    <button class="btn btn-primary btn-sm" @click="showCreateGroupModal = true">
                                        + Create Group
                                    </button>
                                </div>
                            </div>
                            <div class="table-wrapper" v-if="adminGroups.length > 0">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>Name</th>
                                            <th>Description</th>
                                            <th>Members</th>
                                            <th>Created</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="group in adminGroups" :key="group.id">
                                            <td>{{ group.id }}</td>
                                            <td>{{ group.name }}</td>
                                            <td>{{ group.description || '-' }}</td>
                                            <td>
                                                <button class="btn btn-ghost btn-sm" @click="showGroupMembers(group)">
                                                    {{ group.member_count || 0 }} members
                                                </button>
                                            </td>
                                            <td>{{ formatDate(group.created_at) }}</td>
                                            <td>
                                                <div style="display: flex; gap: 4px;">
                                                    <button class="btn btn-ghost btn-sm" @click="editGroup(group)" title="Edit Group">
                                                        ‚úèÔ∏è
                                                    </button>
                                                    <button class="btn btn-ghost btn-sm" @click="confirmDeleteGroup(group)" title="Delete Group">
                                                        üóëÔ∏è
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div v-else class="card-body">
                                <p style="text-align: center; color: var(--text-muted);">No groups yet. Create one to get started.</p>
                            </div>
                        </div>
                    </template>
                </div>

                <!-- Settings Tab -->
                <div v-if="activeTab === 'settings'">
                    <div v-if="!isAdmin" class="alert alert-danger">
                        You must be logged in as an admin to access settings.
                    </div>
                    <template v-else>
                    <div class="card" style="margin-bottom: 24px;">
                        <div class="card-header">
                            <span class="card-title">Default Discord Webhook</span>
                        </div>
                        <div class="card-body">
                            <div v-if="alertMessage" class="alert" :class="alertType === 'success' ? 'alert-success' : 'alert-danger'">
                                {{ alertMessage }}
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Webhook URL</label>
                                <input type="text" class="form-input" v-model="webhookUrl" 
                                       placeholder="https://discord.com/api/webhooks/...">
                                <p class="form-hint" v-if="config.discord_webhook_url_masked">
                                    Current: {{ config.discord_webhook_url_masked }}
                                </p>
                                <p class="form-hint">This is the default webhook that receives all stock notifications.</p>
                            </div>
                            
                            <div style="display: flex; gap: 12px;">
                                <button class="btn btn-primary" @click="saveWebhook" :disabled="saving">
                                    {{ saving ? 'Saving...' : 'Save Webhook' }}
                                </button>
                                <button class="btn btn-secondary" @click="testWebhook" :disabled="testing">
                                    {{ testing ? 'Testing...' : 'Test Webhook' }}
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <span class="card-title">Monitored Plans</span>
                            <span class="badge badge-info">{{ plans.length }} plans</span>
                        </div>
                        <div class="table-wrapper">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Plan Code</th>
                                        <th>Name</th>
                                        <th>Specs</th>
                                        <th>Price</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-for="plan in plans" :key="plan.plan_code">
                                        <td>
                                            <a :href="'#/status?plan=' + encodeURIComponent(plan.plan_code)">
                                                {{ plan.plan_code }}
                                            </a>
                                        </td>
                                        <td>{{ plan.display_name }}</td>
                                        <td>{{ plan.specs || '‚Äî' }}</td>
                                        <td>{{ plan.price || '‚Äî' }}</td>
                                        <td>
                                            <span class="badge" :class="plan.enabled ? 'badge-success' : 'badge-danger'">
                                                {{ plan.enabled ? 'Enabled' : 'Disabled' }}
                                            </span>
                                        </td>
                                        <td>
                                            <button class="btn btn-sm" 
                                                    :class="plan.enabled ? 'btn-danger' : 'btn-success'"
                                                    @click="togglePlanEnabled(plan)">
                                                {{ plan.enabled ? 'Disable' : 'Enable' }}
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    </template>
                </div>

                <!-- My Alerts Tab (User Subscriptions) -->
                <div v-if="activeTab === 'my-alerts'">
                    <div v-if="!isAuthenticated" class="empty-state card">
                        <h3>üîî Personal Alerts</h3>
                        <p>Sign in to set up personalized Discord notifications for specific plans.</p>
                        <button class="btn btn-primary" @click="showLoginModal = true" style="margin-top: 16px;">
                            Login to Continue
                        </button>
                    </div>
                    
                    <template v-else>
                        <!-- Account Settings Section -->
                        <div class="card" style="margin-bottom: 24px;">
                            <div class="card-header">
                                <span class="card-title">üë§ My Account</span>
                            </div>
                            <div class="card-body">
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 16px; background: var(--bg-tertiary); border-radius: 8px;">
                                    <div>
                                        <div style="font-weight: 500;">{{ currentUser?.email }}</div>
                                        <div style="font-size: 0.75rem; color: var(--text-muted);">Account Settings</div>
                                    </div>
                                    <button class="btn btn-secondary btn-sm" @click="showChangePasswordModal = true">
                                        üîë Change Password
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- User Webhooks Section -->
                        <div class="card" style="margin-bottom: 24px;">
                            <div class="card-header">
                                <span class="card-title">üîó My Webhooks</span>
                                <button class="btn btn-primary btn-sm" @click="showAddWebhookModal = true">
                                    + Add Webhook
                                </button>
                            </div>
                            <div class="card-body">
                                <div v-if="userWebhooks.length === 0" class="empty-state" style="padding: 24px;">
                                    <p>No webhooks configured. Add a Discord or Slack webhook to receive personal notifications.</p>
                                </div>
                                <div v-else>
                                    <div v-for="wh in userWebhooks" :key="wh.id" 
                                         style="display: flex; justify-content: space-between; align-items: center; padding: 12px 16px; background: var(--bg-tertiary); border-radius: 8px; margin-bottom: 8px;">
                                        <div>
                                            <div style="font-weight: 500; display: flex; align-items: center; gap: 8px;">
                                                <span>{{ wh.webhook_type === 'slack' ? 'üí¨' : 'üéÆ' }}</span>
                                                {{ wh.webhook_name }}
                                                <span class="badge" style="font-size: 0.65rem; text-transform: uppercase;">{{ wh.webhook_type || 'discord' }}</span>
                                            </div>
                                            <div style="font-size: 0.75rem; color: var(--text-muted);">{{ wh.webhook_url_masked }}</div>
                                        </div>
                                        <div style="display: flex; gap: 8px; align-items: center;">
                                            <span class="badge" :class="wh.is_active ? 'badge-success' : 'badge-muted'">
                                                {{ wh.is_active ? 'Active' : 'Disabled' }}
                                            </span>
                                            <button class="btn btn-ghost btn-sm" @click="testUserWebhook(wh.id)" title="Test">üì§</button>
                                            <button class="btn btn-ghost btn-sm" @click="toggleUserWebhook(wh)" title="Toggle">
                                                {{ wh.is_active ? '‚è∏Ô∏è' : '‚ñ∂Ô∏è' }}
                                            </button>
                                            <button class="btn btn-ghost btn-sm" @click="deleteUserWebhook(wh.id)" title="Delete">üóëÔ∏è</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Plan Subscriptions Section -->
                        <div class="card">
                            <div class="card-header">
                                <span class="card-title">üìã Plan Subscriptions</span>
                                <span class="badge badge-info">{{ userSubscriptions.length }} subscribed</span>
                            </div>
                            <div class="card-body">
                                <p style="color: var(--text-secondary); margin-bottom: 16px;">
                                    Select which plans you want to receive personal notifications for when they come back in stock.
                                </p>
                                
                                <div style="display: flex; gap: 8px; margin-bottom: 16px;">
                                    <button class="btn btn-secondary btn-sm" @click="selectAllPlans">Select All</button>
                                    <button class="btn btn-secondary btn-sm" @click="deselectAllPlans">Deselect All</button>
                                    <button class="btn btn-primary btn-sm" @click="saveSubscriptions" :disabled="savingSubscriptions">
                                        {{ savingSubscriptions ? 'Saving...' : 'Save Changes' }}
                                    </button>
                                </div>

                                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 12px;">
                                    <div v-for="plan in allPlansForSubscription" :key="plan.plan_code"
                                         class="dc-card" :class="{ available: selectedPlans[plan.plan_code] }"
                                         @click="togglePlanSubscription(plan.plan_code)"
                                         style="cursor: pointer;">
                                        <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                                            <div>
                                                <div style="font-weight: 500;">{{ plan.display_name || plan.plan_code }}</div>
                                                <div style="font-size: 0.75rem; color: var(--text-muted);">{{ plan.plan_code }}</div>
                                                <div v-if="plan.specs" style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 4px;">
                                                    {{ plan.specs }}
                                                </div>
                                            </div>
                                            <div style="display: flex; align-items: center; gap: 8px;">
                                                <span v-if="plan.price" style="color: var(--accent); font-size: 0.875rem;">{{ plan.price }}</span>
                                                <input type="checkbox" 
                                                       :checked="selectedPlans[plan.plan_code]"
                                                       @click.stop="togglePlanSubscription(plan.plan_code)"
                                                       style="width: 18px; height: 18px; cursor: pointer;">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- My Notification History -->
                        <div class="card" style="margin-top: 24px;">
                            <div class="card-header">
                                <span class="card-title">üìú My Notification History</span>
                            </div>
                            <div v-if="userNotifications.length === 0" class="empty-state" style="padding: 40px;">
                                <p>No notifications sent yet.</p>
                            </div>
                            <div v-else class="table-wrapper">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Time</th>
                                            <th>Plan</th>
                                            <th>Datacenter</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="item in userNotifications" :key="item.id">
                                            <td>{{ formatDate(item.sent_at) }}</td>
                                            <td>{{ item.plan_code }}</td>
                                            <td>{{ item.datacenter }}</td>
                                            <td>
                                                <span class="badge" :class="item.success ? 'badge-success' : 'badge-danger'">
                                                    {{ item.success ? 'Sent' : 'Failed' }}
                                                </span>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </template>
                </div>
            </div>
        </main>

        <!-- Pricing Modal -->
        <div v-if="pricingModal.visible" class="modal-overlay" @click.self="pricingModal.visible = false">
            <div class="modal">
                <div class="modal-header">
                    <span class="modal-title">{{ pricingModal.planCode }} Pricing</span>
                    <button class="modal-close" @click="pricingModal.visible = false">&times;</button>
                </div>
                <div class="modal-body">
                    <div v-if="pricingModal.loading" class="loading" style="padding: 40px;">
                        <div class="spinner"></div>
                    </div>
                    <div v-else-if="pricingModal.tiers.length === 0">
                        <p style="color: var(--text-muted);">No pricing data available.</p>
                    </div>
                    <div v-else>
                        <div v-for="tier in pricingModal.tiers" :key="tier.commitment_months"
                             class="pricing-tier" :class="{ best: tier.commitment_months === 12 }">
                            <div class="pricing-label">
                                {{ tier.commitment_months === 0 ? 'No Commitment' : tier.commitment_months + ' Month' }}
                                <small v-if="tier.commitment_months === 12">Best Value</small>
                            </div>
                            <div class="pricing-value">{{ tier.price }}</div>
                        </div>
                        <p class="pricing-note">
                            Prices from OVH Catalog API<br>
                            Last updated: {{ pricingModal.lastUpdated || 'Unknown' }}
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Toast -->
        <div v-if="toast.visible" class="toast">{{ toast.message }}</div>
        
        <!-- Refresh Indicator -->
        <div class="refresh-indicator" :class="{ visible: isRefreshing }">
            <span class="mini-spinner"></span>
            <span>Updating...</span>
        </div>

        <!-- Login Modal -->
        <div v-if="showLoginModal" class="modal-overlay" @click.self="showLoginModal = false">
            <div class="modal">
                <div class="modal-header">
                    <span class="modal-title">Login</span>
                    <button class="modal-close" @click="showLoginModal = false">&times;</button>
                </div>
                <div class="modal-body">
                    <div v-if="authError" class="alert alert-danger">{{ authError }}</div>
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-input" v-model="loginForm.email" 
                               placeholder="you@example.com" @keyup.enter="handleLogin">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" class="form-input" v-model="loginForm.password" 
                               placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" @keyup.enter="handleLogin">
                    </div>
                    <button class="btn btn-primary" style="width: 100%;" @click="handleLogin" :disabled="authLoading">
                        {{ authLoading ? 'Logging in...' : 'Login' }}
                    </button>
                    <p style="text-align: center; margin-top: 16px; color: var(--text-muted);">
                        Don't have an account? 
                        <a href="#" @click.prevent="showLoginModal = false; showRegisterModal = true;">Sign up</a>
                    </p>
                </div>
            </div>
        </div>

        <!-- Register Modal -->
        <div v-if="showRegisterModal" class="modal-overlay" @click.self="showRegisterModal = false">
            <div class="modal">
                <div class="modal-header">
                    <span class="modal-title">Create Account</span>
                    <button class="modal-close" @click="showRegisterModal = false">&times;</button>
                </div>
                <div class="modal-body">
                    <div v-if="authError" class="alert alert-danger">{{ authError }}</div>
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-input" v-model="registerForm.email" 
                               placeholder="you@example.com">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Username</label>
                        <input type="text" class="form-input" v-model="registerForm.username" 
                               placeholder="johndoe">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" class="form-input" v-model="registerForm.password" 
                               placeholder="At least 8 characters">
                        <p class="form-hint">Must be at least 8 characters</p>
                    </div>
                    <button class="btn btn-primary" style="width: 100%;" @click="handleRegister" :disabled="authLoading">
                        {{ authLoading ? 'Creating account...' : 'Create Account' }}
                    </button>
                    <p style="text-align: center; margin-top: 16px; color: var(--text-muted);">
                        Already have an account? 
                        <a href="#" @click.prevent="showRegisterModal = false; showLoginModal = true;">Login</a>
                    </p>
                </div>
            </div>
        </div>

        <!-- Add Webhook Modal -->
        <div v-if="showAddWebhookModal" class="modal-overlay" @click.self="showAddWebhookModal = false">
            <div class="modal" style="max-width: 500px;">
                <div class="modal-header">
                    <span class="modal-title">Add Webhook</span>
                    <button class="modal-close" @click="showAddWebhookModal = false">&times;</button>
                </div>
                <div class="modal-body">
                    <div v-if="webhookError" class="alert alert-danger">{{ webhookError }}</div>
                    
                    <!-- Webhook Type Selector -->
                    <div class="form-group">
                        <label class="form-label">Webhook Type *</label>
                        <div style="display: flex; gap: 12px;">
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 12px 16px; border: 2px solid var(--border); border-radius: 8px; flex: 1; transition: all 0.2s;"
                                   :style="newWebhookForm.webhook_type === 'discord' ? 'border-color: var(--primary); background: rgba(96, 165, 250, 0.1);' : ''">
                                <input type="radio" v-model="newWebhookForm.webhook_type" value="discord" style="display: none;">
                                <span style="font-size: 1.5rem;">üéÆ</span>
                                <span>Discord</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 12px 16px; border: 2px solid var(--border); border-radius: 8px; flex: 1; transition: all 0.2s;"
                                   :style="newWebhookForm.webhook_type === 'slack' ? 'border-color: var(--primary); background: rgba(96, 165, 250, 0.1);' : ''">
                                <input type="radio" v-model="newWebhookForm.webhook_type" value="slack" style="display: none;">
                                <span style="font-size: 1.5rem;">üí¨</span>
                                <span>Slack</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Webhook Name *</label>
                        <input type="text" class="form-input" v-model="newWebhookForm.name" 
                               :placeholder="newWebhookForm.webhook_type === 'slack' ? 'My Slack Channel' : 'My Discord Server'">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Webhook URL *</label>
                        <input type="text" class="form-input" v-model="newWebhookForm.url" 
                               :placeholder="newWebhookForm.webhook_type === 'slack' ? 'https://hooks.slack.com/services/...' : 'https://discord.com/api/webhooks/...'">
                        <p class="form-hint" v-if="newWebhookForm.webhook_type === 'discord'">
                            Get this from Discord Server Settings ‚Üí Integrations ‚Üí Webhooks
                        </p>
                        <p class="form-hint" v-else>
                            Get this from Slack App ‚Üí Incoming Webhooks ‚Üí Add New Webhook to Workspace
                        </p>
                    </div>
                    
                    <!-- Slack-specific options -->
                    <template v-if="newWebhookForm.webhook_type === 'slack'">
                        <hr style="border: 0; border-top: 1px solid var(--border); margin: 16px 0;">
                        <h4 style="margin-bottom: 12px; color: var(--text-secondary);">üí¨ Slack Options (Optional)</h4>
                        
                        <div class="form-group">
                            <label class="form-label">Channel Override</label>
                            <input type="text" class="form-input" v-model="newWebhookForm.slack_channel" 
                                   placeholder="#alerts">
                            <p class="form-hint">Override the default channel (requires appropriate permissions)</p>
                        </div>
                    </template>
                    
                    <!-- Discord-specific options -->
                    <template v-if="newWebhookForm.webhook_type === 'discord'">
                        <hr style="border: 0; border-top: 1px solid var(--border); margin: 16px 0;">
                        <h4 style="margin-bottom: 12px; color: var(--text-secondary);">üé® Discord Customization (Optional)</h4>
                        
                        <div class="form-group">
                            <label class="form-label">Bot Username</label>
                            <input type="text" class="form-input" v-model="newWebhookForm.bot_username" 
                                   placeholder="OVH Stock Alert">
                            <p class="form-hint">Override the webhook's default username</p>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Avatar URL</label>
                            <input type="text" class="form-input" v-model="newWebhookForm.avatar_url" 
                                   placeholder="https://example.com/avatar.png">
                            <p class="form-hint">Override the webhook's default avatar</p>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Embed Color</label>
                            <div style="display: flex; gap: 8px; align-items: center;">
                                <input type="color" v-model="webhookColorPicker" @input="newWebhookForm.embed_color = webhookColorPicker.replace('#', '')" 
                                       style="width: 50px; height: 38px; border: none; background: none; cursor: pointer;">
                                <input type="text" class="form-input" v-model="newWebhookForm.embed_color" 
                                       placeholder="3FB950" style="flex: 1;">
                            </div>
                            <p class="form-hint">Hex color code without # (e.g., 3FB950 for green)</p>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Mention Role ID</label>
                            <input type="text" class="form-input" v-model="newWebhookForm.mention_role_id" 
                                   placeholder="123456789012345678">
                            <p class="form-hint">Discord role ID to mention when stock is available</p>
                        </div>
                    </template>
                    
                    <div style="display: flex; gap: 16px; margin-top: 16px;">
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" v-model="newWebhookForm.include_price">
                            <span>Include Price</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" v-model="newWebhookForm.include_specs">
                            <span>Include Specs</span>
                        </label>
                    </div>
                    
                    <button class="btn btn-primary" style="width: 100%; margin-top: 16px;" @click="handleAddWebhook" :disabled="addingWebhook">
                        {{ addingWebhook ? 'Adding...' : 'Add Webhook' }}
                    </button>
                </div>
            </div>
        </div>

        <!-- Change Password Modal -->
        <div v-if="showChangePasswordModal" class="modal-overlay" @click.self="showChangePasswordModal = false">
            <div class="modal" style="max-width: 420px;">
                <div class="modal-header">
                    <span class="modal-title">üîë Change Password</span>
                    <button class="modal-close" @click="showChangePasswordModal = false">&times;</button>
                </div>
                <div class="modal-body">
                    <div v-if="passwordError" class="alert alert-danger">{{ passwordError }}</div>
                    <div v-if="passwordSuccess" class="alert alert-success">{{ passwordSuccess }}</div>
                    
                    <div class="form-group">
                        <label class="form-label">Current Password *</label>
                        <input type="password" class="form-input" v-model="passwordForm.current_password" 
                               placeholder="Enter your current password">
                    </div>
                    <div class="form-group">
                        <label class="form-label">New Password *</label>
                        <input type="password" class="form-input" v-model="passwordForm.new_password" 
                               placeholder="Enter new password">
                        <p class="form-hint">
                            Must be at least 8 characters with uppercase, lowercase, digit, and special character.
                        </p>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Confirm New Password *</label>
                        <input type="password" class="form-input" v-model="passwordForm.confirm_password" 
                               placeholder="Confirm new password">
                    </div>
                    
                    <button class="btn btn-primary" style="width: 100%; margin-top: 8px;" @click="changePassword" :disabled="changingPassword">
                        {{ changingPassword ? 'Changing...' : 'Change Password' }}
                    </button>
                    <p class="form-hint" style="text-align: center; margin-top: 12px;">
                        You will be logged out after changing your password.
                    </p>
                </div>
            </div>
        </div>

        <!-- Create User Modal (Admin) -->
        <div v-if="showCreateUserModal" class="modal-overlay" @click.self="showCreateUserModal = false">
            <div class="modal">
                <div class="modal-header">
                    <span class="modal-title">Create New User</span>
                    <button class="modal-close" @click="showCreateUserModal = false">&times;</button>
                </div>
                <div class="modal-body">
                    <div v-if="createUserError" class="alert alert-danger">{{ createUserError }}</div>
                    <div v-if="createUserSuccess" class="alert alert-success">{{ createUserSuccess }}</div>
                    <div class="form-group">
                        <label class="form-label">Email *</label>
                        <input type="email" class="form-input" v-model="createUserForm.email" 
                               placeholder="user@example.com">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Username *</label>
                        <input type="text" class="form-input" v-model="createUserForm.username" 
                               placeholder="johndoe">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Password *</label>
                        <input type="password" class="form-input" v-model="createUserForm.password" 
                               placeholder="At least 8 characters">
                    </div>
                    <div style="display: flex; gap: 16px; margin-bottom: 16px;">
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" v-model="createUserForm.is_active">
                            <span>Active</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" v-model="createUserForm.is_admin">
                            <span>Admin</span>
                        </label>
                    </div>
                    <button class="btn btn-primary" style="width: 100%;" @click="handleCreateUser" :disabled="creatingUser">
                        {{ creatingUser ? 'Creating...' : 'Create User' }}
                    </button>
                </div>
            </div>
        </div>

        <!-- Create Group Modal (Admin) -->
        <div v-if="showCreateGroupModal" class="modal-overlay" @click.self="showCreateGroupModal = false">
            <div class="modal">
                <div class="modal-header">
                    <span class="modal-title">Create New Group</span>
                    <button class="modal-close" @click="showCreateGroupModal = false">&times;</button>
                </div>
                <div class="modal-body">
                    <div v-if="groupError" class="alert alert-danger">{{ groupError }}</div>
                    <div class="form-group">
                        <label class="form-label">Group Name *</label>
                        <input type="text" class="form-input" v-model="createGroupForm.name" 
                               placeholder="Engineering Team">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Description</label>
                        <textarea class="form-input" v-model="createGroupForm.description" 
                                  placeholder="Optional description" rows="3"></textarea>
                    </div>
                    <button class="btn btn-primary" style="width: 100%;" @click="handleCreateGroup" :disabled="savingGroup">
                        {{ savingGroup ? 'Creating...' : 'Create Group' }}
                    </button>
                </div>
            </div>
        </div>

        <!-- Edit Group Modal (Admin) -->
        <div v-if="showEditGroupModal" class="modal-overlay" @click.self="showEditGroupModal = false">
            <div class="modal">
                <div class="modal-header">
                    <span class="modal-title">Edit Group</span>
                    <button class="modal-close" @click="showEditGroupModal = false">&times;</button>
                </div>
                <div class="modal-body">
                    <div v-if="groupError" class="alert alert-danger">{{ groupError }}</div>
                    <div class="form-group">
                        <label class="form-label">Group Name *</label>
                        <input type="text" class="form-input" v-model="editGroupForm.name" 
                               placeholder="Engineering Team">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Description</label>
                        <textarea class="form-input" v-model="editGroupForm.description" 
                                  placeholder="Optional description" rows="3"></textarea>
                    </div>
                    <button class="btn btn-primary" style="width: 100%;" @click="handleUpdateGroup" :disabled="savingGroup">
                        {{ savingGroup ? 'Saving...' : 'Save Changes' }}
                    </button>
                </div>
            </div>
        </div>

        <!-- Group Members Modal (Admin) -->
        <div v-if="showGroupMembersModal" class="modal-overlay" @click.self="showGroupMembersModal = false">
            <div class="modal" style="max-width: 600px;">
                <div class="modal-header">
                    <span class="modal-title">Members of {{ selectedGroup?.name }}</span>
                    <button class="modal-close" @click="showGroupMembersModal = false">&times;</button>
                </div>
                <div class="modal-body">
                    <div v-if="groupMembersError" class="alert alert-danger">{{ groupMembersError }}</div>
                    
                    <!-- Add Member Form -->
                    <div style="display: flex; gap: 8px; margin-bottom: 16px;">
                        <select class="form-input" v-model="addMemberUserId" style="flex: 1;">
                            <option value="">Select user to add...</option>
                            <option v-for="user in availableUsersForGroup" :key="user.id" :value="user.id">
                                {{ user.username }} ({{ user.email }})
                            </option>
                        </select>
                        <select class="form-input" v-model="addMemberRole" style="width: 120px;">
                            <option value="member">Member</option>
                            <option value="admin">Admin</option>
                        </select>
                        <button class="btn btn-primary" @click="handleAddGroupMember" :disabled="!addMemberUserId || addingMember">
                            {{ addingMember ? '...' : 'Add' }}
                        </button>
                    </div>
                    
                    <!-- Members List -->
                    <div v-if="groupMembers.length > 0">
                        <div v-for="member in groupMembers" :key="member.user_id" 
                             style="display: flex; align-items: center; justify-content: space-between; padding: 12px; border: 1px solid var(--border); border-radius: var(--radius-sm); margin-bottom: 8px;">
                            <div>
                                <strong>{{ member.username }}</strong>
                                <span style="color: var(--text-muted); margin-left: 8px;">{{ member.email }}</span>
                                <span class="badge" :class="member.role === 'admin' ? 'badge-purple' : 'badge-muted'" style="margin-left: 8px;">
                                    {{ member.role }}
                                </span>
                            </div>
                            <button class="btn btn-ghost btn-sm" @click="handleRemoveGroupMember(member)" title="Remove from group">
                                üóëÔ∏è
                            </button>
                        </div>
                    </div>
                    <p v-else style="text-align: center; color: var(--text-muted);">No members in this group yet.</p>
                </div>
            </div>
        </div>
    </div>


    <script src="/static/js/app.js"></script>
    
    <!-- Site Footer -->
    <footer style="
        background: var(--bg-secondary);
        border-top: 1px solid var(--border);
        padding: 24px 0;
        margin-top: 48px;
        font-size: 12px;
        color: var(--text-muted);
    ">
        <div style="max-width: 1600px; margin: 0 auto; padding: 0 24px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 12px;">
            <div>
                &copy; <span id="footer-year"></span> OVH Inventory Checker &middot; Maintained by <a href="https://fouts.dev" target="_blank" rel="noopener" style="color: var(--accent);">fouts.dev</a>
            </div>
            <div style="display: flex; gap: 16px; align-items: center;">
                <span title="Build SHA">Build: <code style="background: var(--bg-tertiary); padding: 2px 6px; border-radius: 4px; font-family: monospace;">__BUILD_SHA__</code></span>
                <span title="Build Date">Built: __BUILD_DATE__</span>
            </div>
        </div>
    </footer>
    <script>document.getElementById('footer-year').textContent = new Date().getFullYear();</script>
</body>
</html>
